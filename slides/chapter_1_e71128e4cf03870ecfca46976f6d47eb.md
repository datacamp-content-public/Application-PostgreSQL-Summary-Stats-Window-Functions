---
title: Insert title here
key: e71128e4cf03870ecfca46976f6d47eb

---
## Welcome to the course!!

```yaml
type: "TitleSlide"
key: "786c169301"
```

`@lower_third`

name: Fernando Gonz√°lez Prada
title: Database & Analytics Professional


`@script`
Hello, welcome to the course 
In this course you are going to learn about Window Functions


---
## What are Window Functions?

```yaml
type: "FullSlide"
key: "835e9ad186"
```

`@part1`
- Window functions are a tool to perform advanced queries for reporting and analytics. 
- They allow you to do complex sorting on a subset of rows.  
- You can use them to solve query problems in a smooth, flexible and efficient way.
- Mastering them is one of the best investments you can make on your analytics career. 
- Because they are defined in the SQL Standard, most dataset vendors include them, even big data platform like Spark and Hive PTF.


`@script`



---
## **Comparing Window Functions with old alternatives**

```yaml
type: "FullSlide"
key: "d6d89ecbd6"
disable_transition: false
```

`@part1`
**Let's start with an example**

```sql
SELECT database_name, batch_date, size_mb	
	,LAG(size_mb) 
		OVER(PARTITION BY database_name ORDER BY batch_date) AS prev_size	
FROM mssql.database_size
```
{{1}}
![](https://assets.datacamp.com/production/repositories/3719/datasets/a44fa8a8bf13d6e126412f564543a82ce9d31bf7/grid lag.JPG){{2}}


`@script`



---
## Let's see if it's performant

```yaml
type: "FullSlide"
key: "f011a782c0"
```

`@part1`
![](https://assets.datacamp.com/production/repositories/3719/datasets/4d6c5ec6540039f763423fdcae25e34d48125db3/explain plan lag.JPG)

We can observe that the query elapsed only 5 milliseconds


`@script`



---
## The old-fashioned way

```yaml
type: "FullSlide"
key: "a69cab9332"
```

`@part1`
```SQL
SELECT database_name, batch_date, size_mb
	,(SELECT size_mb FROM mssql.database_size AS prev
		WHERE prev.database_name = curr.database_name 
        AND prev.batch_date < curr.batch_date
		ORDER BY batch_date DESC 
		LIMIT 1) 
		AS prev_date	
FROM mssql.database_size curr

```{{1}}

![](https://assets.datacamp.com/production/repositories/3719/datasets/3fd0eb4bc548de80b32534b58a6098668eea8d8f/grid correlated.JPG){{2}}


`@script`



---
## But...what about the performance?

```yaml
type: "FullSlide"
key: "c59e92e64b"
```

`@part1`
![](https://assets.datacamp.com/production/repositories/3719/datasets/74c723e510739708a9b0771dfdf02e3e083aec7c/explain plan correlated.JPG)

As you can see, the query execution time was 22 milliseconds, more that 4x the window function time


`@script`



---
## Let's practice!!

```yaml
type: "FinalSlide"
key: "882748e1b2"
```

`@script`


